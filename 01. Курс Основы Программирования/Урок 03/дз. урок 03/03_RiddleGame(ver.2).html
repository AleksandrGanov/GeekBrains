<meta charset="utf-8">
<script type="text/javascript">

	/*
	ОПИСАНИЕ:
	---------------
	-- пользователю предлагается указать ответ на каждую из загадок
	-- ответ можно давать символами в любом регистре, программа для сравнения переводить ответы
		в нижний регистр
	-- пользователь может пропустить загадку через нажатие кнопки "отмена"
	-- по окончанию игры программа считает количество верных ответов

	ДОРАБОТКА:
	---------------
	-- в качестве хранилища для загадок и ответов на них использован двухмерный массив, при этом для реализации нескольких ответов
		во второй элемент массива помещен дополнительный массив, который содержит несколько ответов
	-- добавлена функция проверки ответов на загадку и выдачи сообщения пользователю "checkAnswer()",
		в функции реализован механизм проверки нескольких возможных ответов на каждую загадку, то есть функция определяет
		если во втором элементе двухмерного массива имеется несколько значений, то путем перебора ищется значение, которое 
		совпадает с ответом пользователя, при нахождении нужного значения программа не продолжает дальше перебор элементов массива ответов
	-- добавлена функция выдачи сообщения "userAlert", в которую передается код типа сообщения для выдачи пользователю
	-- убрана переменная "riddleTextBase", т.к. она была использована только один раз в форме выдачи текста загадки, сэкономлена 1 строка кода
	-- убрана переменная "riddleAnswer", т.к. в данной версии программы вместо двух массивов (массив загадок и массив ответов на загадки)
		использует двухмерный массив, содержащий сразу загадку и ответ/ответы на нее
	*/

	// РЕАЛИЗАЦИЯ ФУНКЦИЙ

	function checkAnswer(i, userAnswer) {
		var rightAnswer = false; //учет верности ответа. изначально предполагается, что ответ неверный

		// проверяем верность ответа если у загадки несколько вариантов ответов
		if (typeof (riddle[i][1]) == "object") {
			for (var j = 0; j < riddle[i][1].length; j++) {
				if (userAnswer.toLowerCase() == riddle[i][1][j]) {
					userAlert(1);
					rightAnswersCount++;
					rightAnswer = true;
					break;
				}
			}
		}
		// проверяем верность ответа если у загадки только один вариант ответа
		if (userAnswer == riddle[i][1]) { userAlert(1); rightAnswersCount++; rightAnswer = true; }

		// выдаем игроку уведомление, если ответ не верный
		if ((i < (riddle.length - 1)) && rightAnswer == false) { userAlert(2); }
		else if (rightAnswer == false) { userAlert(3); }
	}
	function userAlert(typeOfMessage) {
		var msgList = [
			"Поздравляем, Вы дали верный ответ", //1
			"К сожалению, Вы дали неверный ответ, переходим к следующей загадке", //2
			"К сожалению, Вы дали неверный ответ, игра окончена", //3
			"Похоже, что Вы пропустили все загадки", //4
			"Вы ответили верно на " + rightAnswersCount + " из " + i + " загадок" //5
		];
		alert(msgList[typeOfMessage - 1]); // показываем пользователю нужный алерт
	}

	//ОСНОВНОЙ КОД

	// объявляем переменные
	var riddle = new Array;
	var rightAnswersCount = 0;
	var skippedRiddlesCount = 0;
	var userAnswer;

	// заполняем массив загадок ["загадка","ответ"]  или ["загадка",[ответ1,ответ2,ответ3]]
	riddle[0] = ["Висит груша, нельзя скушать", ["лампочка", "лампа", "лампа накаливания"]];
	riddle[1] = ["Зимой и летом одним цветом", ["елка", "ель", "елочка"]];
	riddle[2] = ["Два конца, два кольца, посредине гвоздик", "ножницы"];
	riddle[3] = ["Без рук, без топоренка, построена избенка", "гнездо"];

	for (var i = 0; i < riddle.length; i++) {
		userAnswer = prompt("Введите ответ на загадку номер: " + (i + 1) + " \n" + "<---" + riddle[i][0] + "--->" +
			"\n(регистр букв значения не имеет)");

		// проверяем на отсутствие значения на случай нажатия кнопки "отмена" 
		// и считаем сколько раз пользователь не стал отвечать на вопрос, то есть нажал "отмена"
		if (userAnswer == null) { skippedRiddlesCount++; continue; }
		checkAnswer(i, userAnswer); // вызываем функцию проверки ответа
	}

	// выдаем пользователю количество верных ответов
	if (skippedRiddlesCount == i) { userAlert(4); } else { userAlert(5); }

</script>